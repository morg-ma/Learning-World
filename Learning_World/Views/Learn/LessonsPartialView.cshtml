@model List<Part>

<style>
    #sidebar {
        width: 250px;
        transition: width 0.3s ease;
        height: 80vh;
        overflow-y: auto;
    }

        #sidebar.collapsed {
            width: 60px;
        }

            #sidebar.collapsed .list-group {
                display: none;
            }

    .lesson-content {
        transition: margin-left 0.3s;
    }

    .collapsed ~ .lesson-content {
        margin-left: 60px;
    }

    .menu-text {
        display: inline-block;
        margin-left: 10px;
    }

    .collapsed .menu-text {
        display: none;
    }

    .list-group-item {
        text-align: left;
    }

    .collapsed .list-group-item {
        text-align: center;
    }

    .list-group-item.active-section {
        border: 2px solid #0d6efd;
        background-color: #f8f9fa;
        border-radius: 5px;
    }
</style>

<div class="d-flex">
    <!-- Sidebar -->
    <div id="sidebar" class="border-end p-2">
        <button class="btn btn-primary w-100 mb-2" onclick="toggleSidebar()">
            <i class="bi bi-list"></i> <span class="menu-text">Hide menu</span>
        </button>
        <div class="list-group">
            @foreach (var part in Model)
            {
                <button class="list-group-item list-group-item-action fw-bold" data-bs-toggle="collapse" data-bs-target="#@part.PartId" aria-expanded="false" aria-controls="@part.PartId">
                    @part.Title
                </button>
                <div class="collapse" id="@part.PartId">
                    @foreach (var lesson in part.Lessons)
                    {
                        <a class="list-group-item list-group-item-action" href="#" onclick="selectLesson(event, '@lesson.LessonId','@lesson.LessonType.TypeName')">
                                @switch (lesson.LessonType.TypeName)
                                {
                                    case "Video":
                                        <i class="bi bi-play-circle"></i>
                                        break;
                                    case "Text":
                                        <i class="bi bi-book"></i>
                                        break;
                                    case "Quiz":
                                        <i class="bi bi-question-circle"></i>
                                        break;
                                    default:
                                        <i class="bi bi-file-earmark-text"></i> <!-- Default icon -->
                                        break;
                                }
                            <span class="lesson-type">@lesson.LessonType.TypeName:</span> @lesson.Title
                        </a>
                    }
                </div>
            }
        </div>
    </div>

    <!-- Main Content -->
    <div id="main" class="lesson-content flex-grow-1 p-3">
       
    </div>
</div>

<script>
   
    // Toggle the sidebar collapsed state
    function toggleSidebar() {
        const sidebar = document.getElementById('sidebar');
        sidebar.classList.toggle('collapsed');
    }

    // Highlight selected lesson and update the main content title
    function selectLesson(event, id, type) {
        document.querySelectorAll('.list-group-item-action').forEach(item => {
            item.style.backgroundColor = '';
            item.style.borderLeft = '';
            item.style.marginLeft = '';
            item.classList.remove('selected');
        });

        const selectedItem = event.currentTarget;
        selectedItem.style.backgroundColor = '#e9ecef';
        selectedItem.style.borderLeft = '3px solid #0d6efd';
        selectedItem.style.marginLeft = '-2px';
        selectedItem.classList.add('selected');
      


        $.ajax({
            url: '@Url.Action("LessonDiaplayPartialView", "Learn")?id=' + id + '&type='+type,
            success: function (result) {
                $("#main").html(result);
                console.log("work")
            }
        });

    }

    // Manage borders based on collapse state
    document.querySelectorAll('.collapse').forEach(collapseElement => {
        collapseElement.addEventListener('shown.bs.collapse', function () {
            const parentButton = collapseElement.previousElementSibling;
            parentButton.classList.add('active-section');
        });

        collapseElement.addEventListener('hidden.bs.collapse', function () {
            const parentButton = collapseElement.previousElementSibling;
            parentButton.classList.remove('active-section');
        });
    });
</script>


@section Scripts
{
    <script src="~/lib/jquery-validation/dist/jquery.validate.min.js"></script>
    <script src="~/lib/jquery-validation-unobtrusive/jquery.validate.unobtrusive.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js"></script>
}

